---
layout: post
title: Applying A Divergent Color Scale to A Gene Expression Heat Map
date: 2014-11-13 22:35:12.000000000 -08:00
categories:
- R
- visualization
tags:
- R
- visualization
status: publish
type: post
published: true
meta:
  _edit_last: '1'
  disable_featured_image: disable_featured_image-no
  single_format_link_url: ''
  single_format_video: ''
  single_format_audio: ''
  single_format_audio_oga: ''
  single_format_quote: ''
  single_format_quote_url: ''
  _wpas_done_all: '1'
author:
  login: nikhilgopal@gmail.com
  email: nikhilgopal@gmail.com
  display_name: Nikhil Gopal
  first_name: ''
  last_name: ''
excerpt: !ruby/object:Hpricot::Doc
  options: {}
---
<p><em>Estimated Read Time: Under 5 minutes</em></p>
<p>This is a quick post about a quick little experiment I tried lately. I saw a <a href="https://medium.com/matter/the-trouble-with-the-purple-election-map-31e6cb9f1827?source=tw-lo_d2937f3b017d-1415167125872">recent post</a> about how red and blue color scales on political heat maps can be misleading--primarily because human perception is not very good at discriminating between shades of purple in the presented scenario. </p>
<p>Since gene expression heat maps are virtually a right of passage in bioinformatics, I thought I'd try and rescale the colors on a gene expression heat map to a properly divergent color scale and visualize the results. Results Below:</p>
<p><a href="{{ site.url }}/uploads/2014/11/old10scale.jpeg"><img src="{{ site.url }}/assets/old10scale.jpeg" alt="old10scale" width="559" height="351" class="alignnone size-full wp-image-371" /></a></p>
<p><a href="{{ site.url }}/uploads/2014/11/new.jpeg"><img src="{{ site.url }}/assets/new.jpeg" alt="new" width="559" height="351" class="alignnone size-full wp-image-372" /></a></p>
<p>At the top is a plot (green and blue) generated using the <a href="http://www2.warwick.ac.uk/fac/sci/moac/people/students/peter_cock/r/heatmap/">code available on Peter Cock's website</a> (but modified to only use 10 colors on the scale). Below that is the plot (red and blue) generated with my modified version.</p>
<p>And of course, code for your consumption:</p>
<p><script src="https://gist.github.com/ngopal/2b25477d21632fe41045.js"></script></p>
<p>Thanks to <a href="http://www.sandia.gov/~kmorel/documents/ColorMaps/">Kenneth Moreland's research on color scales, and Jos√© Gama's implementation in R</a> (now part of Rgnuplot), all it took was a one line modification of Peter's code to switch to the new divergent color scale!</p>
<p>The new scale does seem to help us visually discriminate between the elements in the "muddy" area of the left plot. However, since the use of the heat map in bioinformatics is more aesthetic than functional, I'm afraid the fruits seem to stop there. Although this is paints a prettier picture, the hierarchical clustering results remain unchanged. Fun to try though! And now we know a divergent color scale function implementation exists in R!</p>
<p>It always takes a while to write a blog post. In return, all I ask is that you share. Also, if you are a Python or R coder and would like to learn to use D3.js, please check out my O'Reilly Media product, <a href="http://bit.ly/d3coffeescript">D3 and Coffeescript: A Python Programmer's Introduction to Web Visualizations</a>.</p>
<p><!-- Begin MailChimp Signup Form --></p>
<link href="//cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css" />
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }<br />
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.<br />
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */<br />
</style>
<div id="mc_embed_signup">
<form action="//nikhilgopal.us3.list-manage.com/subscribe/post?u=247178139134c0616342e1953&amp;id=88361a83c7" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
<div id="mc_embed_signup_scroll">
	<label for="mce-EMAIL">Subscribe for more visualization and code posts</label><br />
	<input type="email" value="Oh man! I can't type in my email fast enough.." name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required /><br />
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--></p>
<div style="position: absolute; left: -5000px;"><input type="text" name="b_247178139134c0616342e1953_88361a83c7" tabindex="-1" value="" /></div>
<div class="clear"><input type="submit" value="Update Me" name="subscribe" id="mc-embedded-subscribe" class="button" /></div>
</p></div>
</form>
</div>
<p><!--End mc_embed_signup--></p>
